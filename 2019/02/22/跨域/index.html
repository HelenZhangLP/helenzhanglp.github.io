<!DOCTYPE html>
<html lang=zh>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="违背同源策略的就是 跨域，可以说跨域 是浏览器同源策略的产生。  浏览器的同源策略(Same-Origin Policy) 最早是由 Netscape（网景）公司提出，是浏览器的一种安全策略。  同源，相同的协议 + 相同的域名 + 相同的端口号同源策略是一种隔离恶意文件的安全机制。对不同源之间的文档或脚本交互进行了限制。不同源是指两个页面的协议、端口、域名有一个不同 与https:&#x2F;&#x2F;deve">
<meta property="og:type" content="article">
<meta property="og:title" content="跨域">
<meta property="og:url" content="https://helenzhanglp.github.io/2019/02/22/%E8%B7%A8%E5%9F%9F/index.html">
<meta property="og:site_name" content="魔女">
<meta property="og:description" content="违背同源策略的就是 跨域，可以说跨域 是浏览器同源策略的产生。  浏览器的同源策略(Same-Origin Policy) 最早是由 Netscape（网景）公司提出，是浏览器的一种安全策略。  同源，相同的协议 + 相同的域名 + 相同的端口号同源策略是一种隔离恶意文件的安全机制。对不同源之间的文档或脚本交互进行了限制。不同源是指两个页面的协议、端口、域名有一个不同 与https:&#x2F;&#x2F;deve">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2019-02-22T10:14:44.000Z">
<meta property="article:modified_time" content="2024-01-26T08:11:21.058Z">
<meta property="article:author" content="Helen Zhang">
<meta property="article:tag" content="browser">
<meta name="twitter:card" content="summary">
    
    
        
          
              <link rel="shortcut icon" href="/images/logo.jpeg">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/logo.jpeg" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
          
        
    
    <!-- title -->
    <title>跨域</title>
    <!-- styles -->
    
<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">

    
<link rel="stylesheet" href="/lib/meslo-LG/styles.css">

    
<link rel="stylesheet" href="/lib/justified-gallery/justifiedGallery.min.css">

    
<link rel="stylesheet" href="/css/style.css">

    <!-- rss -->
    
    
    <!-- jquery -->
    
<script src="/lib/jquery/jquery.min.js"></script>

<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 5.4.2"></head>

<body>
    <div class="banner">
<div id="blogtitel" class="blogtitel">魔女</div>
<ul id="wrapper" class="wrapper">
  <div class="sun">
    <div class="star"></div>
  </div>
  <div class="mercury">
    <div class="planet">
      <div class="shadow"></div>
    </div>
  </div>
  <div class="venus">
    <div class="planet">
      <div class="shadow"></div>
    </div>
  </div>
  <div class="earth">
    <div class="planet"><div class="shadow"></div></div>
  </div>
  <div class="mars">
    <div class="planet"><div class="shadow"></div></div>
  </div>
  <div class="jupiter">
    <div class="planet"><div class="shadow"></div></div>
  </div>
</ul>
</div>

    <div class="background">
      
        <div id="header-post">
  <a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i
      class="fa fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        
          <li><a href="/">
              Home
            </a></li>
          
          <li><a href="/about/">
              About
            </a></li>
          
          <li><a href="/archives/">
              Writing
            </a></li>
          
          <li><a href="/tags/">
              Tags
            </a></li>
          
          <li><a target="_blank" rel="noopener" href="https://github.com/HelenZhangLP">
              Projects
            </a></li>
          
      </ul>
    </span>
    <br />
    <span id="actions">
      <ul>
        
          <li><a class="icon" href="/2019/02/25/vue-use-vue-component/"><i class="fa fa-chevron-left" aria-hidden="true"
                onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li>
          
            
              <li><a class="icon" href="/2019/02/20/CSS-BFC/"><i class="fa fa-chevron-right"
                    aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a>
              </li>
              
                <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i
                      class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();'
                      onmouseout='$("#i-top").toggle();'></i></a></li>
                <li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true"
                      onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();'
                      onclick='$("#share").toggle();return false;'></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br />
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://helenzhanglp.github.io/2019/02/22/%E8%B7%A8%E5%9F%9F/"><i class="fa fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://helenzhanglp.github.io/2019/02/22/%E8%B7%A8%E5%9F%9F/&text=跨域"><i class="fa fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://helenzhanglp.github.io/2019/02/22/%E8%B7%A8%E5%9F%9F/&title=跨域"><i class="fa fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://helenzhanglp.github.io/2019/02/22/%E8%B7%A8%E5%9F%9F/&is_video=false&description=跨域"><i class="fa fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=跨域&body=Check out this article: https://helenzhanglp.github.io/2019/02/22/%E8%B7%A8%E5%9F%9F/"><i class="fa fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://helenzhanglp.github.io/2019/02/22/%E8%B7%A8%E5%9F%9F/&title=跨域"><i class="fa fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://helenzhanglp.github.io/2019/02/22/%E8%B7%A8%E5%9F%9F/&title=跨域"><i class="fa fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://helenzhanglp.github.io/2019/02/22/%E8%B7%A8%E5%9F%9F/&title=跨域"><i class="fa fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://helenzhanglp.github.io/2019/02/22/%E8%B7%A8%E5%9F%9F/&title=跨域"><i class="fa fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://helenzhanglp.github.io/2019/02/22/%E8%B7%A8%E5%9F%9F/&name=跨域&description=&lt;blockquote&gt;
&lt;p&gt;违背同源策略的就是 &lt;strong&gt;跨域&lt;/strong&gt;，可以说&lt;strong&gt;跨域&lt;/strong&gt; 是浏览器同源策略的产生。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;浏览器的同源策略-Same-Origin-Policy&#34;&gt;&lt;a href=&#34;#浏览器的同源策略-Same-Origin-Policy&#34; class=&#34;headerlink&#34; title=&#34;浏览器的同源策略(Same-Origin Policy)&#34;&gt;&lt;/a&gt;&lt;a href=&#34;https://developer.mozilla.org/zh-CN/docs/Web/Security/Same-origin_policy&#34;&gt;浏览器的同源策略(Same-Origin Policy)&lt;/a&gt;&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;最早是由 Netscape（网景）公司提出，是浏览器的一种安全策略。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;u&gt;&lt;span class=&#34;custom-box custom-box-933&#34;&gt;同源，相同的协议 + 相同的域名 + 相同的端口号&lt;/span&gt;&lt;code&gt;同源&lt;/code&gt;策略是一种隔离恶意文件的安全机制。&lt;/u&gt;&lt;br&gt;&lt;span class=&#34;custom-box custom-box-939&#34;&gt;对不同源之间的文档或脚本交互进行了限制。&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;custom-box custom-box-393&#34;&gt;&lt;strong&gt;不同源&lt;/strong&gt;是指两个页面的协议、端口、域名有一个不同&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;与&lt;code&gt;https://developer.mozilla.org/zh-CN/docs/Web/Security/Same-origin_policy&lt;/code&gt;对比是否同源&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align=&#34;center&#34;&gt;序号&lt;/th&gt;
&lt;th&gt;link&lt;/th&gt;
&lt;th&gt;协议&lt;/th&gt;
&lt;th&gt;域名&lt;/th&gt;
&lt;th&gt;端口&lt;/th&gt;
&lt;th&gt;是否同源&lt;/th&gt;
&lt;th&gt;原因&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;&lt;tr&gt;
&lt;td align=&#34;center&#34;&gt;1&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://developer.mozilla.org/en-US/docs/Web/Security/Same-origin_policy&#34;&gt;https://developer.mozilla.org/en-US/docs/Web/Security/Same-origin_policy&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;https&lt;/td&gt;
&lt;td&gt;developer.mozilla.org&lt;/td&gt;
&lt;td&gt;80&lt;/td&gt;
&lt;td&gt;是&lt;/td&gt;
&lt;td&gt;路径不是同源的限制条件&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align=&#34;center&#34;&gt;2&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;http://developer.mozilla.org/zh-CN/docs/Web/Security/Same-origin_policy&#34;&gt;http://developer.mozilla.org/zh-CN/docs/Web/Security/Same-origin_policy&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;http&lt;/td&gt;
&lt;td&gt;developer.mozilla.org&lt;/td&gt;
&lt;td&gt;80&lt;/td&gt;
&lt;td&gt;否&lt;/td&gt;
&lt;td&gt;协议不同&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align=&#34;center&#34;&gt;3&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://develop.mozilla.org/zh-CN/docs/Web/Security/Same-origin_policy&#34;&gt;https://develop.mozilla.org/zh-CN/docs/Web/Security/Same-origin_policy&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;https&lt;/td&gt;
&lt;td&gt;develop.mozilla.org&lt;/td&gt;
&lt;td&gt;80&lt;/td&gt;
&lt;td&gt;否&lt;/td&gt;
&lt;td&gt;域名不同&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align=&#34;center&#34;&gt;4&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://developer.mozilla.org:81/index.html&#34;&gt;https://developer.mozilla.org:81/index.html&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;https&lt;/td&gt;
&lt;td&gt;developer.mozilla.org&lt;/td&gt;
&lt;td&gt;81&lt;/td&gt;
&lt;td&gt;否\是&lt;/td&gt;
&lt;td&gt;端口不同（IE 中端口号不在同源策略中，固在IE 浏览器中，属同源）&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align=&#34;center&#34;&gt;5&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://new.developer.mozilla.org:81/index.html&#34;&gt;https://new.developer.mozilla.org:81/index.html&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;https&lt;/td&gt;
&lt;td&gt;new.developer.mozilla.org&lt;/td&gt;
&lt;td&gt;80&lt;/td&gt;
&lt;td&gt;否&lt;/td&gt;
&lt;td&gt;域名 new.developer.mozilla.org 不同&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;h3 id=&#34;IE-是否同源略有差异&#34;&gt;&lt;a href=&#34;#IE-是否同源略有差异&#34; class=&#34;headerlink&#34; title=&#34;IE 是否同源略有差异&#34;&gt;&lt;/a&gt;IE 是否同源略有差异&lt;/h3&gt;&lt;blockquote&gt;
&lt;ul&gt;
&lt;li&gt;&lt;input checked disabled type=&#34;checkbox&#34;&gt; 在 IE 中，两个高度互信的域名不用遵守同源策略限制。&lt;code&gt;授信范围（Trust Zones）&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;input disabled type=&#34;checkbox&#34;&gt; &lt;span class=&#34;custom-box custom-box-933&#34;&gt;在 IE 中，&lt;code&gt;端口&lt;/code&gt;号不在同源策略中，即&lt;strong&gt;协议、域名相同则不受同源策略限制&lt;/strong&gt;&lt;/span&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;figure class=&#34;highlight javascript&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable language_&#34;&gt;document&lt;/span&gt;.&lt;span class=&#34;property&#34;&gt;domain&lt;/span&gt; = &lt;span class=&#34;string&#34;&gt;&amp;quot;company.com&amp;quot;&lt;/span&gt;; &lt;span class=&#34;comment&#34;&gt;// 修改当前域名&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h2 id=&#34;跨域解决方案&#34;&gt;&lt;a href=&#34;#跨域解决方案&#34; class=&#34;headerlink&#34; title=&#34;跨域解决方案&#34;&gt;&lt;/a&gt;跨域解决方案&lt;/h2&gt;"><i class="fa fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B5%8F%E8%A7%88%E5%99%A8%E7%9A%84%E5%90%8C%E6%BA%90%E7%AD%96%E7%95%A5-Same-Origin-Policy"><span class="toc-number">1.</span> <span class="toc-text">浏览器的同源策略(Same-Origin Policy)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#IE-%E6%98%AF%E5%90%A6%E5%90%8C%E6%BA%90%E7%95%A5%E6%9C%89%E5%B7%AE%E5%BC%82"><span class="toc-number">1.1.</span> <span class="toc-text">IE 是否同源略有差异</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B7%A8%E5%9F%9F%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88"><span class="toc-number">2.</span> <span class="toc-text">跨域解决方案</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#document-domain-iframe"><span class="toc-number">2.1.</span> <span class="toc-text">document.domain + iframe</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B7%A8%E5%9F%9F%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88-jsonp"><span class="toc-number">2.2.</span> <span class="toc-text">跨域解决方案 - jsonp</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BB%A5%E4%B8%8B%E6%A1%88%E4%BE%8B%E6%98%AF%E7%94%A8-node-%E5%90%AF%E5%90%8E%E7%AB%AF%E6%9C%8D%E5%8A%A1"><span class="toc-number">2.2.0.1.</span> <span class="toc-text">以下案例是用 node 启后端服务</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B7%A8%E5%9F%9F%E8%B5%84%E6%BA%90%E5%85%B1%E4%BA%AB%EF%BC%88CORS%EF%BC%89%E5%BD%93%E5%89%8D%E4%B8%BB%E6%B5%81%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88"><span class="toc-number">2.3.</span> <span class="toc-text">跨域资源共享（CORS）当前主流解决方案</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#CORS-%E8%B7%A8%E5%9F%9F%E8%B5%84%E6%BA%90%E5%85%B1%E4%BA%AB"><span class="toc-number">2.3.1.</span> <span class="toc-text">CORS 跨域资源共享</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%84%E6%A3%80%E8%AF%B7%E6%B1%82"><span class="toc-number">2.4.</span> <span class="toc-text">预检请求</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%80%E5%8D%95%E8%AF%B7%E6%B1%82%E4%B8%8E%E9%A2%84%E6%A3%80%E8%AF%B7%E6%B1%82"><span class="toc-number">2.5.</span> <span class="toc-text">简单请求与预检请求</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#JSONP-%E7%9A%84%E6%A6%82%E5%BF%B5%E4%B8%8E%E7%89%B9%E7%82%B9"><span class="toc-number">2.6.</span> <span class="toc-text">JSONP 的概念与特点</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Error"><span class="toc-number">3.</span> <span class="toc-text">Error</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#ERROR-%E2%80%94%E2%80%94-Access-to-XMLHttpRequest-at-%E2%80%98file-Users-%E2%80%A6-jsx-jsx-basic-js%E2%80%99-from-origin-%E2%80%98null%E2%80%99-has-been-blocked-by-CORS-policy-Cross-origin-requests-are-only-supported-for-protocol-schemes-http-data-chrome-chrome-extension-chrome-untrusted-https"><span class="toc-number">3.0.1.</span> <span class="toc-text">ERROR —— Access to XMLHttpRequest at ‘file:&#x2F;&#x2F;Users&#x2F;…&#x2F;jsx&#x2F;jsx-basic.js’ from origin ‘null’ has been blocked by CORS policy: Cross origin requests are only supported for protocol schemes: http,data,chrome,chrome-extension,chrome-untrusted,https</span></a></li></ol></li></ol></li></ol>
    </div>
  </span>
</div>
      
      <div class="content index width mx-auto px2 my4">
          
          <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header class="header">
    
    <h1 class="posttitle" itemprop="name headline">
        跨域
    </h1>



      <div class="meta">
        <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <span itemprop="name">
            魔女
                    
          </span>
        </span>
        
    <div class="postdate">
        <time datetime="2019-02-22T10:14:44.000Z" itemprop="datePublished">2019-02-22</time>
    </div>


          
    <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/browser/" rel="tag">browser</a></li></ul>

      </div>
  </header>
  

    <div class="content" itemprop="articleBody">
      <blockquote>
<p>违背同源策略的就是 <strong>跨域</strong>，可以说<strong>跨域</strong> 是浏览器同源策略的产生。</p>
</blockquote>
<h2 id="浏览器的同源策略-Same-Origin-Policy"><a href="#浏览器的同源策略-Same-Origin-Policy" class="headerlink" title="浏览器的同源策略(Same-Origin Policy)"></a><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/Security/Same-origin_policy">浏览器的同源策略(Same-Origin Policy)</a></h2><blockquote>
<p>最早是由 Netscape（网景）公司提出，是浏览器的一种安全策略。</p>
</blockquote>
<p><u><span class='custom-box custom-box-933'>同源，相同的协议 + 相同的域名 + 相同的端口号</span><code>同源</code>策略是一种隔离恶意文件的安全机制。</u><br><span class='custom-box custom-box-939'>对不同源之间的文档或脚本交互进行了限制。</span><br><span class='custom-box custom-box-393'><strong>不同源</strong>是指两个页面的协议、端口、域名有一个不同</span></p>
<p>与<code>https://developer.mozilla.org/zh-CN/docs/Web/Security/Same-origin_policy</code>对比是否同源</p>
<table>
<thead>
<tr>
<th align="center">序号</th>
<th>link</th>
<th>协议</th>
<th>域名</th>
<th>端口</th>
<th>是否同源</th>
<th>原因</th>
</tr>
</thead>
<tbody><tr>
<td align="center">1</td>
<td><a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/Security/Same-origin_policy">https://developer.mozilla.org/en-US/docs/Web/Security/Same-origin_policy</a></td>
<td>https</td>
<td>developer.mozilla.org</td>
<td>80</td>
<td>是</td>
<td>路径不是同源的限制条件</td>
</tr>
<tr>
<td align="center">2</td>
<td><a target="_blank" rel="noopener" href="http://developer.mozilla.org/zh-CN/docs/Web/Security/Same-origin_policy">http://developer.mozilla.org/zh-CN/docs/Web/Security/Same-origin_policy</a></td>
<td>http</td>
<td>developer.mozilla.org</td>
<td>80</td>
<td>否</td>
<td>协议不同</td>
</tr>
<tr>
<td align="center">3</td>
<td><a target="_blank" rel="noopener" href="https://develop.mozilla.org/zh-CN/docs/Web/Security/Same-origin_policy">https://develop.mozilla.org/zh-CN/docs/Web/Security/Same-origin_policy</a></td>
<td>https</td>
<td>develop.mozilla.org</td>
<td>80</td>
<td>否</td>
<td>域名不同</td>
</tr>
<tr>
<td align="center">4</td>
<td><a target="_blank" rel="noopener" href="https://developer.mozilla.org:81/index.html">https://developer.mozilla.org:81/index.html</a></td>
<td>https</td>
<td>developer.mozilla.org</td>
<td>81</td>
<td>否\是</td>
<td>端口不同（IE 中端口号不在同源策略中，固在IE 浏览器中，属同源）</td>
</tr>
<tr>
<td align="center">5</td>
<td><a target="_blank" rel="noopener" href="https://new.developer.mozilla.org:81/index.html">https://new.developer.mozilla.org:81/index.html</a></td>
<td>https</td>
<td>new.developer.mozilla.org</td>
<td>80</td>
<td>否</td>
<td>域名 new.developer.mozilla.org 不同</td>
</tr>
</tbody></table>
<h3 id="IE-是否同源略有差异"><a href="#IE-是否同源略有差异" class="headerlink" title="IE 是否同源略有差异"></a>IE 是否同源略有差异</h3><blockquote>
<ul>
<li><input checked="" disabled="" type="checkbox"> 在 IE 中，两个高度互信的域名不用遵守同源策略限制。<code>授信范围（Trust Zones）</code></li>
<li><input disabled="" type="checkbox"> <span class='custom-box custom-box-933'>在 IE 中，<code>端口</code>号不在同源策略中，即<strong>协议、域名相同则不受同源策略限制</strong></span></li>
</ul>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">document</span>.<span class="property">domain</span> = <span class="string">&quot;company.com&quot;</span>; <span class="comment">// 修改当前域名</span></span><br></pre></td></tr></table></figure>

<h2 id="跨域解决方案"><a href="#跨域解决方案" class="headerlink" title="跨域解决方案"></a>跨域解决方案</h2><h3 id="document-domain-iframe"><a href="#document-domain-iframe" class="headerlink" title="document.domain + iframe"></a>document.domain + iframe</h3><p><code>共享数据的两个页面域名有共同的主域名或b域名是a域名的子域名</code></p>
<blockquote>
<p>上表 4、5 中，主域名相同，均为 ‘mozilla.org’<br>  <a target="_blank" rel="noopener" href="https://developer.mozilla.org:81/index.html">https://developer.mozilla.org:81/index.html</a> 中<br>  <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">src</span>=<span class="string">&quot;https://new.developer.mozilla.org:81/index.html&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="variable language_">document</span>.<span class="property">domain</span> = <span class="string">&#x27;mozilla.org&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">var</span> user = <span class="string">&#x27;HelenZhanglp&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><br><a target="_blank" rel="noopener" href="https://new.developer.mozilla.org:81/index.html">https://new.developer.mozilla.org:81/index.html</a><br>  <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="variable language_">document</span>.<span class="property">domain</span> = <span class="string">&#x27;mozilla.org&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><br>*** 如此，new.developer.mozilla.org 所以访问到 developer.mozilla.org 中的数据 ***</p>
</blockquote>
<h3 id="跨域解决方案-jsonp"><a href="#跨域解决方案-jsonp" class="headerlink" title="跨域解决方案 - jsonp"></a>跨域解决方案 - jsonp</h3><p><span class='custom-box custom-box-339'>在页面中用 about:blank 或 JavaScript: URL 执行的脚本会继承打开该 URL 的文档的源，因为这些类型的 URLs 没有明确包含有关原始服务器的信息。</span><br>例如，about:blank 通常作为父脚本写入内容的新的空白弹出窗口的 URL（例如，通过  Window.open()  机制）。 如果此弹出窗口也包含代码，则该代码将继承与创建它的脚本相同的源。</p>
<blockquote>
<p>jsonp 是 json 的使用模式，使用 jsonp 跨域，没有兼容方面问题<br><code>img,iframe,script</code> 三个标签可以通过 src 属性获取不同源的服务器资源<br>当使用 jsonp 模式发送请求时 <em><strong>需要服务端支持</strong></em> 需要用 callback 函数包裹 json 串</p>
</blockquote>
<h5 id="以下案例是用-node-启后端服务"><a href="#以下案例是用-node-启后端服务" class="headerlink" title="以下案例是用 node 启后端服务"></a>以下案例是用 node 启后端服务</h5><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">// localhost:4000/index.html</span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">var</span> fn = <span class="keyword">function</span>(<span class="params">data</span>)&#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(data.<span class="property">name</span>, <span class="string">&#x27;jsonp&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&#x27;http://localhost:8888/?callback=fn&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// node server.js</span></span><br><span class="line"><span class="keyword">let</span> http = <span class="built_in">require</span>(<span class="string">&#x27;http&#x27;</span>)</span><br><span class="line"><span class="keyword">var</span> urllib = <span class="built_in">require</span>(<span class="string">&#x27;url&#x27;</span>);</span><br><span class="line"></span><br><span class="line">http.<span class="title function_">createServer</span>(<span class="keyword">function</span>(<span class="params">request, response</span>) &#123;</span><br><span class="line">  response.<span class="title function_">writeHead</span>(<span class="number">200</span>, &#123;<span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;text/plain&#x27;</span>&#125;)</span><br><span class="line">  <span class="keyword">var</span> params = urllib.<span class="title function_">parse</span>(request.<span class="property">url</span>, <span class="literal">true</span>)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (params.<span class="property">query</span> &amp;&amp; params.<span class="property">query</span>.<span class="property">callback</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> str =  params.<span class="property">query</span>.<span class="property">callback</span> + <span class="string">&#x27;(&#x27;</span> + <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(&#123;</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&#x27;HelenZhanglp&#x27;</span></span><br><span class="line">    &#125;) + <span class="string">&#x27;)&#x27;</span>; <span class="comment">//jsonp</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(str)</span><br><span class="line"></span><br><span class="line">    response.<span class="title function_">end</span>(str);</span><br><span class="line">  &#125;</span><br><span class="line">  response.<span class="title function_">end</span>(<span class="string">&#x27;localhost:8888&#x27;</span>)</span><br><span class="line">&#125;).<span class="title function_">listen</span>(<span class="number">8888</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Server running at http://127.0.0.1:8888/index.js&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>以上 Demo 二个注意点：</p>
<ol>
<li><a target="_blank" rel="noopener" href="http://localhost:8888/?callback=fn">http://localhost:8888/?callback=fn</a> 注意这个链接，参数之前加 <code>?</code>。如此，node 服务端可以通过 urllib.parse(request.url, true) 进入参数解析</li>
<li>函数 fn 是以变量赋值方式声明的，这里有个 <strong><a href="">变量提升</a></strong> 的概念，一定要先声明赋值后再引用，如 demo (localhost:4000/index.html)。顺序不能错。</li>
<li>注意：<span class='custom-box custom-box-933'>JSONP只支持GET请求，服务端可能在JSONP响应中夹带恶意代码，判断是否请求成功是困难的。</span></li>
</ol>
<h3 id="跨域资源共享（CORS）当前主流解决方案"><a href="#跨域资源共享（CORS）当前主流解决方案" class="headerlink" title="跨域资源共享（CORS）当前主流解决方案"></a><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Access_control_CORS">跨域资源共享（CORS）</a><span class='custom-box custom-box-939'>当前主流解决方案</span></h3><ol>
<li> <a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Glossary/CORS">CORS</a> Cross-Origin Resource Sharing，跨域资源共享）是一个系统，<span class='custom-box custom-box-933'>它由一系列传输的HTTP头组成</span>，这些 <span class='custom-box custom-box-393'><code>HTTP头决定浏览器是否阻止前端 JavaScript 代码获取服务器资源</code></span>。浏览器同源安全策略 <span class='custom-box custom-box-339'>默认阻止“跨域”获取资源</span>。但是 CORS 给了web服务器这样的权限，<span class='custom-box custom-box-993'>即服务器可以选择，允许跨域请求访问到它们的资源。</span> 那么浏览器的跨域访问限制就被解除了。</li>
<li>跨域资源共享(CORS) 是一种机制，它使用额外的 HTTP 头来告诉浏览器，让运行在一个 origin (domain) 上的Web应用被准许访问来自不同源服务器上的指定的资源。当一个资源从与该资源本身所在的服务器不同的域、协议或端口请求一个资源时，资源会发起一个跨域 HTTP 请求。比如，站点 <a target="_blank" rel="noopener" href="http://domain-a.com/">http://domain-a.com</a> 的某 HTML 页面通过 <img> 的 src 请求 <a target="_blank" rel="noopener" href="http://domain-b.com/image.jpg%E3%80%82%E7%BD%91%E7%BB%9C%E4%B8%8A%E7%9A%84%E8%AE%B8%E5%A4%9A%E9%A1%B5%E9%9D%A2%E9%83%BD%E4%BC%9A%E5%8A%A0%E8%BD%BD%E6%9D%A5%E8%87%AA%E4%B8%8D%E5%90%8C%E5%9F%9F%E7%9A%84CSS%E6%A0%B7%E5%BC%8F%E8%A1%A8%EF%BC%8C%E5%9B%BE%E5%83%8F%E5%92%8C%E8%84%9A%E6%9C%AC%E7%AD%89%E8%B5%84%E6%BA%90%E3%80%82">http://domain-b.com/image.jpg。网络上的许多页面都会加载来自不同域的CSS样式表，图像和脚本等资源。</a><br>出于安全原因，浏览器限制从脚本内发起的跨源HTTP请求。例如，XMLHttpRequest 和 Fetch API 遵循同源策略。这意味着使用这些 API的 Web 应用程序只能从加载应用程序的同一个域请求HTTP资源，除非响应报文包含了正确CORS响应头。</li>
</ol>
<pre class="mermaid"> flowchart TB
 subgraph " "
  browser[浏览器] -->|跨域请求| server[接口服务器]
  server -.->|响应的结果被浏览器拦截<br/>网页无法获取跨域响应数据| browser
 end
 subgraph " "
  browser1[浏览器] -->|跨域请求| server1["接口服务器<br/> Access-Control-Allow: *"]
  server1 -->|服务端配置 cors 响应头<br/>解除浏览器跨域访问限制| browser1
 end</pre>

<h4 id="CORS-跨域资源共享"><a href="#CORS-跨域资源共享" class="headerlink" title="CORS 跨域资源共享"></a>CORS 跨域资源共享</h4><p>浏览器的<code>同源安全策略</code>默认阻止网页跨域获取资源。<u>但如果接口服务器配置了 CORS 相关的 HTTP 响应头，就可以解除浏览器的跨域访问限制。</u></p>
<ul>
<li>响应头 Access-Control-Allow-Origin, origin 参数值指定了<strong>允许访问该资源外域的 URL</strong><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">res.<span class="title function_">setHeader</span>(<span class="string">&#x27;Access-Control-Allow-Origin&#x27;</span>, <span class="string">&#x27;http://abc.com&#x27;</span>) <span class="comment">// 或者为 * 允许所有资源访问</span></span><br></pre></td></tr></table></figure></li>
<li>响应头 Access-Control-Allow-Headers<br>默认情况下，CORS 仅支持客户端向服务器发送如下9个请求头：<br>Accept,Accept-Language,Content-Language,DPR,Downlink,Save-Data,Viewport-Width,Width,Content-Type(text/plain, multipart/form-data,application/x-www-form-urlencoded 三者之一)<br><span class='custom-box custom-box-933'>如果客户端向服务器发送了额外的请求头信息，服务器端需要通过 Access-Control-Allow-Headers 对额外的请求头进行声明，否则请求失败。</span><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">res.<span class="title function_">setHeader</span>(<span class="string">&#x27;Access-Control-Allow-Headers&#x27;</span>, <span class="string">&#x27;custom-header&#x27;</span>)</span><br></pre></td></tr></table></figure></li>
<li>响应头 Access-Control-Allow-Methods<br>默认情况下，CORS 只支持客户端发起 GET/POST/HEAD 请求。<br>如果客户端希望通过 PUT、DELETE 等方式请求服务器资源，需要在服务器端，通过 Access-Control-Allow-Methods 指明实际请求所允许使用的 HTTP 方法<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">res.<span class="title function_">setHeader</span>(<span class="string">&#x27;Access-Control-Allow-Methods&#x27;</span>, <span class="string">&#x27;*&#x27;</span>)</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="预检请求"><a href="#预检请求" class="headerlink" title="预检请求"></a>预检请求</h3><ul>
<li>请求方式为 GET/POST/HEAD 之外的请求 Method 类型；</li>
<li>请求头中包含自定义头部字段；</li>
<li>向服务器发送 application/json 格式的数据</li>
</ul>
<p>在浏览器与服务器正式通信之前，浏览器会先发送 OPTION 请求进行预检，以获知服务器是否允许该实际请求，这一次的 OPTION 请求称为“预检请求”。服务器成功响应预检请求后，才会发送真正的请求，并且携带真实数据。</p>
<h3 id="简单请求与预检请求"><a href="#简单请求与预检请求" class="headerlink" title="简单请求与预检请求"></a>简单请求与预检请求</h3><p><span class='custom-box custom-box-933'>简单请求：客户端与服务器端只会发生一次请求。</span><br><span class='custom-box custom-box-933'>预检请求：客户端与服务器之间会发生两次请求，OPTION 预检请求成功后，会发起真正的请求。</span></p>
<h3 id="JSONP-的概念与特点"><a href="#JSONP-的概念与特点" class="headerlink" title="JSONP 的概念与特点"></a>JSONP 的概念与特点</h3><blockquote>
<p>浏览器端通过 <code>&lt;script&gt;</code> 标签的 src 属性，请求服务器上的数据，同时，服务器返回一个函数的调用。这种请求方式叫做 JSONP<br><span class='custom-box custom-box-339'>特点：</span> JSONP 不是真正的 Ajax 请求，它没有用 XMLHttpRequest<br><span class='custom-box custom-box-339'>特点：</span> JSONP 仅支持 GET 请求，不支持 POST,PUT,DELETE 请求</p>
</blockquote>
<pre class="mermaid"> flowchart TB
 callback[获取客户端发送过来的回调函数的名字] --> data[拿到通过 JSONP 形式发送给客户的数据]
 data --> sliptJoint[拼接函数调用字符串]
 sliptJoint --> e["将函数响给客户端script标签进行解析"]</pre>
<p><a target="_blank" rel="noopener" href="https://github.com/HelenZhangLP/demo/blob/master/node/src/demo13/index.js">demo for jsonp</a></p>
<h2 id="Error"><a href="#Error" class="headerlink" title="Error"></a>Error</h2><h4 id="ERROR-——-Access-to-XMLHttpRequest-at-‘file-Users-…-jsx-jsx-basic-js’-from-origin-‘null’-has-been-blocked-by-CORS-policy-Cross-origin-requests-are-only-supported-for-protocol-schemes-http-data-chrome-chrome-extension-chrome-untrusted-https"><a href="#ERROR-——-Access-to-XMLHttpRequest-at-‘file-Users-…-jsx-jsx-basic-js’-from-origin-‘null’-has-been-blocked-by-CORS-policy-Cross-origin-requests-are-only-supported-for-protocol-schemes-http-data-chrome-chrome-extension-chrome-untrusted-https" class="headerlink" title="ERROR —— Access to XMLHttpRequest at ‘file://Users/…/jsx/jsx-basic.js’ from origin ‘null’ has been blocked by CORS policy: Cross origin requests are only supported for protocol schemes: http,data,chrome,chrome-extension,chrome-untrusted,https"></a><font color='red'>ERROR —— Access to XMLHttpRequest at ‘file://Users/…/jsx/jsx-basic.js’ from origin ‘null’ has been blocked by CORS policy: Cross origin requests are only supported for protocol schemes: http,data,chrome,chrome-extension,chrome-untrusted,https</font></h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span> <span class="attr">dir</span>=<span class="string">&quot;ltr&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- react core code when deploying, replace &quot;development.js&quot; with &quot;production.min.js&quot; --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://unpkg.com/react@16/umd/react.development.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- react about dom&#x27;s function --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://unpkg.com/react-dom@16/umd/react-dom.development.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- Don&#x27;t use this in production  --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://unpkg.com/babel-standalone@6.15.0/babel.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;root&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/babel&quot;</span> <span class="attr">src</span>=<span class="string">&quot;./import.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>解决办法：<br>http-server 打开一个本地服务，通过本地服务请求</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Starting up http-server, serving ./</span><br><span class="line">Available on:</span><br><span class="line">  http://127.0.0.1:8080</span><br><span class="line">  http://192.168.5.10:8080</span><br><span class="line">Hit CTRL-C to stop the server</span><br><span class="line">[2021-03-03T04:44:16.576Z]  &quot;GET /jsx/jsx.html&quot; &quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Geck</span><br><span class="line">o) Chrome/88.0.4324.192 Safari/537.36&quot;</span><br></pre></td></tr></table></figure>

    </div>
</article>


      </div>
      
       <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="/tags/">Tags</a></li>
         
          <li><a target="_blank" rel="noopener" href="https://github.com/HelenZhangLP">Projects</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B5%8F%E8%A7%88%E5%99%A8%E7%9A%84%E5%90%8C%E6%BA%90%E7%AD%96%E7%95%A5-Same-Origin-Policy"><span class="toc-number">1.</span> <span class="toc-text">浏览器的同源策略(Same-Origin Policy)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#IE-%E6%98%AF%E5%90%A6%E5%90%8C%E6%BA%90%E7%95%A5%E6%9C%89%E5%B7%AE%E5%BC%82"><span class="toc-number">1.1.</span> <span class="toc-text">IE 是否同源略有差异</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B7%A8%E5%9F%9F%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88"><span class="toc-number">2.</span> <span class="toc-text">跨域解决方案</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#document-domain-iframe"><span class="toc-number">2.1.</span> <span class="toc-text">document.domain + iframe</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B7%A8%E5%9F%9F%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88-jsonp"><span class="toc-number">2.2.</span> <span class="toc-text">跨域解决方案 - jsonp</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BB%A5%E4%B8%8B%E6%A1%88%E4%BE%8B%E6%98%AF%E7%94%A8-node-%E5%90%AF%E5%90%8E%E7%AB%AF%E6%9C%8D%E5%8A%A1"><span class="toc-number">2.2.0.1.</span> <span class="toc-text">以下案例是用 node 启后端服务</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B7%A8%E5%9F%9F%E8%B5%84%E6%BA%90%E5%85%B1%E4%BA%AB%EF%BC%88CORS%EF%BC%89%E5%BD%93%E5%89%8D%E4%B8%BB%E6%B5%81%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88"><span class="toc-number">2.3.</span> <span class="toc-text">跨域资源共享（CORS）当前主流解决方案</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#CORS-%E8%B7%A8%E5%9F%9F%E8%B5%84%E6%BA%90%E5%85%B1%E4%BA%AB"><span class="toc-number">2.3.1.</span> <span class="toc-text">CORS 跨域资源共享</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%84%E6%A3%80%E8%AF%B7%E6%B1%82"><span class="toc-number">2.4.</span> <span class="toc-text">预检请求</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%80%E5%8D%95%E8%AF%B7%E6%B1%82%E4%B8%8E%E9%A2%84%E6%A3%80%E8%AF%B7%E6%B1%82"><span class="toc-number">2.5.</span> <span class="toc-text">简单请求与预检请求</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#JSONP-%E7%9A%84%E6%A6%82%E5%BF%B5%E4%B8%8E%E7%89%B9%E7%82%B9"><span class="toc-number">2.6.</span> <span class="toc-text">JSONP 的概念与特点</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Error"><span class="toc-number">3.</span> <span class="toc-text">Error</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#ERROR-%E2%80%94%E2%80%94-Access-to-XMLHttpRequest-at-%E2%80%98file-Users-%E2%80%A6-jsx-jsx-basic-js%E2%80%99-from-origin-%E2%80%98null%E2%80%99-has-been-blocked-by-CORS-policy-Cross-origin-requests-are-only-supported-for-protocol-schemes-http-data-chrome-chrome-extension-chrome-untrusted-https"><span class="toc-number">3.0.1.</span> <span class="toc-text">ERROR —— Access to XMLHttpRequest at ‘file:&#x2F;&#x2F;Users&#x2F;…&#x2F;jsx&#x2F;jsx-basic.js’ from origin ‘null’ has been blocked by CORS policy: Cross origin requests are only supported for protocol schemes: http,data,chrome,chrome-extension,chrome-untrusted,https</span></a></li></ol></li></ol></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://helenzhanglp.github.io/2019/02/22/%E8%B7%A8%E5%9F%9F/"><i class="fa fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://helenzhanglp.github.io/2019/02/22/%E8%B7%A8%E5%9F%9F/&text=跨域"><i class="fa fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://helenzhanglp.github.io/2019/02/22/%E8%B7%A8%E5%9F%9F/&title=跨域"><i class="fa fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://helenzhanglp.github.io/2019/02/22/%E8%B7%A8%E5%9F%9F/&is_video=false&description=跨域"><i class="fa fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=跨域&body=Check out this article: https://helenzhanglp.github.io/2019/02/22/%E8%B7%A8%E5%9F%9F/"><i class="fa fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://helenzhanglp.github.io/2019/02/22/%E8%B7%A8%E5%9F%9F/&title=跨域"><i class="fa fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://helenzhanglp.github.io/2019/02/22/%E8%B7%A8%E5%9F%9F/&title=跨域"><i class="fa fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://helenzhanglp.github.io/2019/02/22/%E8%B7%A8%E5%9F%9F/&title=跨域"><i class="fa fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://helenzhanglp.github.io/2019/02/22/%E8%B7%A8%E5%9F%9F/&title=跨域"><i class="fa fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://helenzhanglp.github.io/2019/02/22/%E8%B7%A8%E5%9F%9F/&name=跨域&description=&lt;blockquote&gt;
&lt;p&gt;违背同源策略的就是 &lt;strong&gt;跨域&lt;/strong&gt;，可以说&lt;strong&gt;跨域&lt;/strong&gt; 是浏览器同源策略的产生。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;浏览器的同源策略-Same-Origin-Policy&#34;&gt;&lt;a href=&#34;#浏览器的同源策略-Same-Origin-Policy&#34; class=&#34;headerlink&#34; title=&#34;浏览器的同源策略(Same-Origin Policy)&#34;&gt;&lt;/a&gt;&lt;a href=&#34;https://developer.mozilla.org/zh-CN/docs/Web/Security/Same-origin_policy&#34;&gt;浏览器的同源策略(Same-Origin Policy)&lt;/a&gt;&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;最早是由 Netscape（网景）公司提出，是浏览器的一种安全策略。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;u&gt;&lt;span class=&#34;custom-box custom-box-933&#34;&gt;同源，相同的协议 + 相同的域名 + 相同的端口号&lt;/span&gt;&lt;code&gt;同源&lt;/code&gt;策略是一种隔离恶意文件的安全机制。&lt;/u&gt;&lt;br&gt;&lt;span class=&#34;custom-box custom-box-939&#34;&gt;对不同源之间的文档或脚本交互进行了限制。&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;custom-box custom-box-393&#34;&gt;&lt;strong&gt;不同源&lt;/strong&gt;是指两个页面的协议、端口、域名有一个不同&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;与&lt;code&gt;https://developer.mozilla.org/zh-CN/docs/Web/Security/Same-origin_policy&lt;/code&gt;对比是否同源&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align=&#34;center&#34;&gt;序号&lt;/th&gt;
&lt;th&gt;link&lt;/th&gt;
&lt;th&gt;协议&lt;/th&gt;
&lt;th&gt;域名&lt;/th&gt;
&lt;th&gt;端口&lt;/th&gt;
&lt;th&gt;是否同源&lt;/th&gt;
&lt;th&gt;原因&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;&lt;tr&gt;
&lt;td align=&#34;center&#34;&gt;1&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://developer.mozilla.org/en-US/docs/Web/Security/Same-origin_policy&#34;&gt;https://developer.mozilla.org/en-US/docs/Web/Security/Same-origin_policy&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;https&lt;/td&gt;
&lt;td&gt;developer.mozilla.org&lt;/td&gt;
&lt;td&gt;80&lt;/td&gt;
&lt;td&gt;是&lt;/td&gt;
&lt;td&gt;路径不是同源的限制条件&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align=&#34;center&#34;&gt;2&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;http://developer.mozilla.org/zh-CN/docs/Web/Security/Same-origin_policy&#34;&gt;http://developer.mozilla.org/zh-CN/docs/Web/Security/Same-origin_policy&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;http&lt;/td&gt;
&lt;td&gt;developer.mozilla.org&lt;/td&gt;
&lt;td&gt;80&lt;/td&gt;
&lt;td&gt;否&lt;/td&gt;
&lt;td&gt;协议不同&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align=&#34;center&#34;&gt;3&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://develop.mozilla.org/zh-CN/docs/Web/Security/Same-origin_policy&#34;&gt;https://develop.mozilla.org/zh-CN/docs/Web/Security/Same-origin_policy&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;https&lt;/td&gt;
&lt;td&gt;develop.mozilla.org&lt;/td&gt;
&lt;td&gt;80&lt;/td&gt;
&lt;td&gt;否&lt;/td&gt;
&lt;td&gt;域名不同&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align=&#34;center&#34;&gt;4&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://developer.mozilla.org:81/index.html&#34;&gt;https://developer.mozilla.org:81/index.html&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;https&lt;/td&gt;
&lt;td&gt;developer.mozilla.org&lt;/td&gt;
&lt;td&gt;81&lt;/td&gt;
&lt;td&gt;否\是&lt;/td&gt;
&lt;td&gt;端口不同（IE 中端口号不在同源策略中，固在IE 浏览器中，属同源）&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align=&#34;center&#34;&gt;5&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://new.developer.mozilla.org:81/index.html&#34;&gt;https://new.developer.mozilla.org:81/index.html&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;https&lt;/td&gt;
&lt;td&gt;new.developer.mozilla.org&lt;/td&gt;
&lt;td&gt;80&lt;/td&gt;
&lt;td&gt;否&lt;/td&gt;
&lt;td&gt;域名 new.developer.mozilla.org 不同&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;h3 id=&#34;IE-是否同源略有差异&#34;&gt;&lt;a href=&#34;#IE-是否同源略有差异&#34; class=&#34;headerlink&#34; title=&#34;IE 是否同源略有差异&#34;&gt;&lt;/a&gt;IE 是否同源略有差异&lt;/h3&gt;&lt;blockquote&gt;
&lt;ul&gt;
&lt;li&gt;&lt;input checked disabled type=&#34;checkbox&#34;&gt; 在 IE 中，两个高度互信的域名不用遵守同源策略限制。&lt;code&gt;授信范围（Trust Zones）&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;input disabled type=&#34;checkbox&#34;&gt; &lt;span class=&#34;custom-box custom-box-933&#34;&gt;在 IE 中，&lt;code&gt;端口&lt;/code&gt;号不在同源策略中，即&lt;strong&gt;协议、域名相同则不受同源策略限制&lt;/strong&gt;&lt;/span&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;figure class=&#34;highlight javascript&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable language_&#34;&gt;document&lt;/span&gt;.&lt;span class=&#34;property&#34;&gt;domain&lt;/span&gt; = &lt;span class=&#34;string&#34;&gt;&amp;quot;company.com&amp;quot;&lt;/span&gt;; &lt;span class=&#34;comment&#34;&gt;// 修改当前域名&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h2 id=&#34;跨域解决方案&#34;&gt;&lt;a href=&#34;#跨域解决方案&#34; class=&#34;headerlink&#34; title=&#34;跨域解决方案&#34;&gt;&lt;/a&gt;跨域解决方案&lt;/h2&gt;"><i class="fa fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
      <ul>
        <li id="toc"><a class="icon" href="#" onclick='$("#toc-footer").toggle();return false;'><i class="fa fa-list fa-lg" aria-hidden="true"></i> TOC</a></li>
        <li id="share"><a class="icon" href="#" onclick='$("#share-footer").toggle();return false;'><i class="fa fa-share-alt fa-lg" aria-hidden="true"></i> Share</a></li>
        <li id="top" style="display:none"><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a></li>
        <li id="menu"><a class="icon" href="#" onclick='$("#nav-footer").toggle();return false;'><i class="fa fa-bars fa-lg" aria-hidden="true"></i> Menu</a></li>
      </ul>
    </div>

  </div>
</div>

      
      <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2024
      Helen Zhang
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        
          <li><a href="/">
              Home
            </a></li>
          
          <li><a href="/about/">
              About
            </a></li>
          
          <li><a href="/archives/">
              Writing
            </a></li>
          
          <li><a href="/tags/">
              Tags
            </a></li>
          
          <li><a target="_blank" rel="noopener" href="https://github.com/HelenZhangLP">
              Projects
            </a></li>
          
      </ul>
    </nav>
  </div>
</footer>


  <!-- <script src='https://unpkg.com/mermaid@10.4.0/dist/mermaid.min.js'></script> -->
  <script src="https://cdn.bootcdn.net/ajax/libs/mermaid/10.4.0/mermaid.min.js"></script>
  <script>
    if (window.mermaid) {
      mermaid.initialize({ theme: 'default' });
    }
  </script>
  
      
<script src="/lib/justified-gallery/jquery.justifiedGallery.min.js"></script>


<script src="/js/main.js"></script>

<!-- Google Analytics -->

<!-- Disqus Comments -->


    </div>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</body>
</html>
