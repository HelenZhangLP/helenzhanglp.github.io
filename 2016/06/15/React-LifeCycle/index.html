<!DOCTYPE html>
<html lang=zh>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="flowchart LR   subgraph 初次渲染阶段     subgraph 初始化阶段       start([strart]) --&gt;|初始化属性&amp;&amp;考验规则|step1[getDefaultProps]       step1 --&gt;|初始化状态| stpe2[getInitialState]     end     subgraph 第一次渲染       step3[&quot;~">
<meta property="og:type" content="article">
<meta property="og:title" content="React 生命周期">
<meta property="og:url" content="https://helenzhanglp.github.io/2016/06/15/React-LifeCycle/index.html">
<meta property="og:site_name" content="魔女">
<meta property="og:description" content="flowchart LR   subgraph 初次渲染阶段     subgraph 初始化阶段       start([strart]) --&gt;|初始化属性&amp;&amp;考验规则|step1[getDefaultProps]       step1 --&gt;|初始化状态| stpe2[getInitialState]     end     subgraph 第一次渲染       step3[&quot;~">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2016-06-15T07:30:25.000Z">
<meta property="article:modified_time" content="2024-01-25T07:31:03.772Z">
<meta property="article:author" content="Helen Zhang">
<meta property="article:tag" content="React">
<meta name="twitter:card" content="summary">
    
    
        
          
              <link rel="shortcut icon" href="/images/logo.jpeg">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/logo.jpeg" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
          
        
    
    <!-- title -->
    <title>React 生命周期</title>
    <!-- styles -->
    
<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">

    
<link rel="stylesheet" href="/lib/meslo-LG/styles.css">

    
<link rel="stylesheet" href="/lib/justified-gallery/justifiedGallery.min.css">

    
<link rel="stylesheet" href="/css/style.css">

    <!-- rss -->
    
    
    <!-- jquery -->
    
<script src="/lib/jquery/jquery.min.js"></script>

<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 5.4.2"></head>

<body>
    <div class="banner">
<div id="blogtitel" class="blogtitel">魔女</div>
<ul id="wrapper" class="wrapper">
  <div class="sun">
    <div class="star"></div>
  </div>
  <div class="mercury">
    <div class="planet">
      <div class="shadow"></div>
    </div>
  </div>
  <div class="venus">
    <div class="planet">
      <div class="shadow"></div>
    </div>
  </div>
  <div class="earth">
    <div class="planet"><div class="shadow"></div></div>
  </div>
  <div class="mars">
    <div class="planet"><div class="shadow"></div></div>
  </div>
  <div class="jupiter">
    <div class="planet"><div class="shadow"></div></div>
  </div>
</ul>
</div>

    <div class="background">
      
        <div id="header-post">
  <a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i
      class="fa fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        
          <li><a href="/">
              Home
            </a></li>
          
          <li><a href="/about/">
              About
            </a></li>
          
          <li><a href="/archives/">
              Writing
            </a></li>
          
          <li><a href="/tags/">
              Tags
            </a></li>
          
          <li><a target="_blank" rel="noopener" href="https://github.com/HelenZhangLP">
              Projects
            </a></li>
          
      </ul>
    </span>
    <br />
    <span id="actions">
      <ul>
        
          <li><a class="icon" href="/2016/07/24/JavaScript-Ajax/"><i class="fa fa-chevron-left" aria-hidden="true"
                onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li>
          
            
              <li><a class="icon" href="/2013/02/03/JavaScript-5.1-%E5%87%BD%E6%95%B0%E5%8F%82%E6%95%B0/"><i class="fa fa-chevron-right"
                    aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a>
              </li>
              
                <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i
                      class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();'
                      onmouseout='$("#i-top").toggle();'></i></a></li>
                <li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true"
                      onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();'
                      onclick='$("#share").toggle();return false;'></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br />
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://helenzhanglp.github.io/2016/06/15/React-LifeCycle/"><i class="fa fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://helenzhanglp.github.io/2016/06/15/React-LifeCycle/&text=React 生命周期"><i class="fa fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://helenzhanglp.github.io/2016/06/15/React-LifeCycle/&title=React 生命周期"><i class="fa fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://helenzhanglp.github.io/2016/06/15/React-LifeCycle/&is_video=false&description=React 生命周期"><i class="fa fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=React 生命周期&body=Check out this article: https://helenzhanglp.github.io/2016/06/15/React-LifeCycle/"><i class="fa fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://helenzhanglp.github.io/2016/06/15/React-LifeCycle/&title=React 生命周期"><i class="fa fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://helenzhanglp.github.io/2016/06/15/React-LifeCycle/&title=React 生命周期"><i class="fa fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://helenzhanglp.github.io/2016/06/15/React-LifeCycle/&title=React 生命周期"><i class="fa fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://helenzhanglp.github.io/2016/06/15/React-LifeCycle/&title=React 生命周期"><i class="fa fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://helenzhanglp.github.io/2016/06/15/React-LifeCycle/&name=React 生命周期&description=&lt;pre class=&#34;mermaid&#34;&gt;  flowchart LR
  subgraph 初次渲染阶段
    subgraph 初始化阶段
      start([strart]) --&gt;|初始化属性&amp;&amp;考验规则|step1[getDefaultProps]
      step1 --&gt;|初始化状态| stpe2[getInitialState]
    end
    subgraph 第一次渲染
      step3[&#34;~UNSAFE_ComponentWillMount~&#34;] --&gt; step4[render]
      step4 --&gt; step5[componentDidMount]
    end
    初始化阶段  --&gt; 第一次渲染
  end&lt;/pre&gt;
&lt;pre class=&#34;mermaid&#34;&gt;  flowchart LR
  第一次渲染 --&gt; 组件更新
  subgraph 组件更新
    condition1{属性改变 or 状态改变} --&gt;|属性改变| step6_1[&#34;~UNSAFE_componentWillReceiveProps~&#34;]
    condition1 --&gt;|状态改变| step6{shouldComponentUpdate}
    step6_1 --&gt; step6
    step6 --&gt;|yes| step7[componentWillUpdate]
    step7 --&gt;|dom-diff| step8[render]
    step8 --&gt; step9[componentDidUpdate]
  end&lt;/pre&gt;
&lt;pre class=&#34;mermaid&#34;&gt;  flowchart LR
  初次渲染阶段 --&gt; 组件更新
  组件更新 --&gt; 组件销毁
  subgraph 组件销毁
    step10[componentwillUnmount]
  end&lt;/pre&gt;
&lt;blockquote&gt;
&lt;p&gt;UNSAFE_* 屏蔽 warning&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;the-components-is-not-recommended&#34;&gt;&lt;a href=&#34;#the-components-is-not-recommended&#34; class=&#34;headerlink&#34; title=&#34;the components is not recommended&#34;&gt;&lt;/a&gt;&lt;font color=&#34;red&#34;&gt;the components is not recommended&lt;/font&gt;&lt;/h2&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;serial number&lt;/th&gt;
&lt;th&gt;component name&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;&lt;tr&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;ComponentWillMount&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;componentWillUpdate&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;h2 id=&#34;第一次渲染&#34;&gt;&lt;a href=&#34;#第一次渲染&#34; class=&#34;headerlink&#34; title=&#34;第一次渲染&#34;&gt;&lt;/a&gt;第一次渲染&lt;/h2&gt;&lt;h3 id=&#34;step1-——-初始化属性-amp-amp-考验规则&#34;&gt;&lt;a href=&#34;#step1-——-初始化属性-amp-amp-考验规则&#34; class=&#34;headerlink&#34; title=&#34;step1 —— 初始化属性&amp;amp;&amp;amp;考验规则&#34;&gt;&lt;/a&gt;step1 —— 初始化属性&amp;amp;&amp;amp;考验规则&lt;/h3&gt;&lt;figure class=&#34;highlight javascript&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;Vote&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;extends&lt;/span&gt; &lt;span class=&#34;title class_ inherited__&#34;&gt;React.Component&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;comment&#34;&gt;/**&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;   * method1: handle init props in constructor function(在 constructor 中初始化属性)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;    constructor(props) &amp;#123;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;      super(props) // 把传递进来的 &amp;#123;...props&amp;#125; 挂载到 this&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;  */&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;span class=&#34;comment&#34;&gt;/**&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;  * method2: 不通过显式声明 constructor 初始化属性，react 内部机制会处理&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;  */&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&#34;step2-——-初始化状态&#34;&gt;&lt;a href=&#34;#step2-——-初始化状态&#34; class=&#34;headerlink&#34; title=&#34;step2 —— 初始化状态&#34;&gt;&lt;/a&gt;step2 —— 初始化状态&lt;/h3&gt;"><i class="fa fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#the-components-is-not-recommended"><span class="toc-number">1.</span> <span class="toc-text">the components is not recommended</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%B8%B2%E6%9F%93"><span class="toc-number">2.</span> <span class="toc-text">第一次渲染</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#step1-%E2%80%94%E2%80%94-%E5%88%9D%E5%A7%8B%E5%8C%96%E5%B1%9E%E6%80%A7-amp-amp-%E8%80%83%E9%AA%8C%E8%A7%84%E5%88%99"><span class="toc-number">2.1.</span> <span class="toc-text">step1 —— 初始化属性&amp;&amp;考验规则</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#step2-%E2%80%94%E2%80%94-%E5%88%9D%E5%A7%8B%E5%8C%96%E7%8A%B6%E6%80%81"><span class="toc-number">2.2.</span> <span class="toc-text">step2 —— 初始化状态</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#step3-%E2%80%94%E2%80%94-ComponentWillMount"><span class="toc-number">2.3.</span> <span class="toc-text">step3 —— ComponentWillMount</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#step4-%E2%80%94%E2%80%94-render"><span class="toc-number">2.4.</span> <span class="toc-text">step4 —— render</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#step5-%E2%80%94%E2%80%94-componentDidMount"><span class="toc-number">2.5.</span> <span class="toc-text">step5 —— componentDidMount</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%84%E4%BB%B6%E6%9B%B4%E6%96%B0"><span class="toc-number">3.</span> <span class="toc-text">组件更新</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#step6-%E2%80%94%E2%80%94-shouldComponentUpdate"><span class="toc-number">3.1.</span> <span class="toc-text">step6 —— shouldComponentUpdate</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#step7-%E2%80%94%E2%80%94-componentWillUpdate"><span class="toc-number">3.2.</span> <span class="toc-text">step7 —— componentWillUpdate</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#step8-%E2%80%94%E2%80%94-render"><span class="toc-number">3.3.</span> <span class="toc-text">step8 —— render</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#step9-%E2%80%94%E2%80%94-componentDidUpdate"><span class="toc-number">3.4.</span> <span class="toc-text">step9 —— componentDidUpdate</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%88%B6%E5%AD%90%E7%BB%84%E4%BB%B6%E6%B8%B2%E6%9F%93"><span class="toc-number">4.</span> <span class="toc-text">父子组件渲染</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%88%B6%E7%BB%84%E4%BB%B6%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%B8%B2%E6%9F%93"><span class="toc-number">4.1.</span> <span class="toc-text">父组件第一次渲染</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%88%B6%E7%BB%84%E4%BB%B6%E6%9B%B4%E6%96%B0"><span class="toc-number">4.2.</span> <span class="toc-text">父组件更新</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Mounting-%E7%BB%84%E4%BB%B6%E7%9A%84%E6%8C%82%E8%BD%BD"><span class="toc-number">4.3.</span> <span class="toc-text">Mounting 组件的挂载</span></a></li></ol></li></ol>
    </div>
  </span>
</div>
      
      <div class="content index width mx-auto px2 my4">
          
          <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header class="header">
    
    <h1 class="posttitle" itemprop="name headline">
        React 生命周期
    </h1>



      <div class="meta">
        <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <span itemprop="name">
            魔女
                    
          </span>
        </span>
        
    <div class="postdate">
        <time datetime="2016-06-15T07:30:25.000Z" itemprop="datePublished">2016-06-15</time>
    </div>


          
    <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/React/" rel="tag">React</a></li></ul>

      </div>
  </header>
  

    <div class="content" itemprop="articleBody">
      <pre class="mermaid">  flowchart LR
  subgraph 初次渲染阶段
    subgraph 初始化阶段
      start([strart]) -->|初始化属性&&考验规则|step1[getDefaultProps]
      step1 -->|初始化状态| stpe2[getInitialState]
    end
    subgraph 第一次渲染
      step3["~UNSAFE_ComponentWillMount~"] --> step4[render]
      step4 --> step5[componentDidMount]
    end
    初始化阶段  --> 第一次渲染
  end</pre>
<pre class="mermaid">  flowchart LR
  第一次渲染 --> 组件更新
  subgraph 组件更新
    condition1{属性改变 or 状态改变} -->|属性改变| step6_1["~UNSAFE_componentWillReceiveProps~"]
    condition1 -->|状态改变| step6{shouldComponentUpdate}
    step6_1 --> step6
    step6 -->|yes| step7[componentWillUpdate]
    step7 -->|dom-diff| step8[render]
    step8 --> step9[componentDidUpdate]
  end</pre>
<pre class="mermaid">  flowchart LR
  初次渲染阶段 --> 组件更新
  组件更新 --> 组件销毁
  subgraph 组件销毁
    step10[componentwillUnmount]
  end</pre>
<blockquote>
<p>UNSAFE_* 屏蔽 warning</p>
</blockquote>
<h2 id="the-components-is-not-recommended"><a href="#the-components-is-not-recommended" class="headerlink" title="the components is not recommended"></a><font color='red'>the components is not recommended</font></h2><table>
<thead>
<tr>
<th>serial number</th>
<th>component name</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>ComponentWillMount</td>
</tr>
<tr>
<td>2</td>
<td>componentWillUpdate</td>
</tr>
</tbody></table>
<h2 id="第一次渲染"><a href="#第一次渲染" class="headerlink" title="第一次渲染"></a>第一次渲染</h2><h3 id="step1-——-初始化属性-amp-amp-考验规则"><a href="#step1-——-初始化属性-amp-amp-考验规则" class="headerlink" title="step1 —— 初始化属性&amp;&amp;考验规则"></a>step1 —— 初始化属性&amp;&amp;考验规则</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Vote</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * method1: handle init props in constructor function(在 constructor 中初始化属性)</span></span><br><span class="line"><span class="comment">    constructor(props) &#123;</span></span><br><span class="line"><span class="comment">      super(props) // 把传递进来的 &#123;...props&#125; 挂载到 this</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"> <span class="comment">/**</span></span><br><span class="line"><span class="comment">  * method2: 不通过显式声明 constructor 初始化属性，react 内部机制会处理</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="step2-——-初始化状态"><a href="#step2-——-初始化状态" class="headerlink" title="step2 —— 初始化状态"></a>step2 —— 初始化状态</h3><p>状态修改，触发视图更新，<code>React.Component.prototype.setState</code> 与 <code>React.Component.prototype.forceUpdate</code> 都可以更新视图。<br><span class='custom-box custom-box-933'><code>React.Component.prototype.forceUpdate</code> 这种方式不推荐使用，因为：</span><br><span class='custom-box custom-box-939'><code>React.Component.prototype.forceUpdate</code> 不会触发 shouldComponentUpdate 生命周期更新。</span></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Vote</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">  state = &#123;</span><br><span class="line">    <span class="attr">supportVote</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="attr">nagativeVote</span>: <span class="number">0</span></span><br><span class="line">  &#125; <span class="comment">// 默认值为 null</span></span><br><span class="line"></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> &#123;supportVote, nagativeVote&#125; = <span class="variable language_">this</span>.<span class="property">state</span></span><br><span class="line">    <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span>=&gt;</span>&#123;</span></span><br><span class="line"><span class="language-xml">        this.setState(&#123;</span></span><br><span class="line"><span class="language-xml">          supportVote: ++supportVote</span></span><br><span class="line"><span class="language-xml">        &#125;)</span></span><br><span class="line"><span class="language-xml">      &#125;&#125;&gt;赞成&#123;supportVote&#125;<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span>=&gt;</span>&#123;</span></span><br><span class="line"><span class="language-xml">        this.state.nagativeVote++</span></span><br><span class="line"><span class="language-xml">        this.forceUpdate()</span></span><br><span class="line"><span class="language-xml">      &#125;&#125;&gt;反对&#123;nagativeVote&#125;<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="step3-——-ComponentWillMount"><a href="#step3-——-ComponentWillMount" class="headerlink" title="step3 —— ComponentWillMount"></a>step3 —— ComponentWillMount</h3><p>非严格模式下：<font color='#ffa'>Warning: componentWillMount has been renamed, and is not recommended for use. See <a target="_blank" rel="noopener" href="https://reactjs.org/link/unsafe-component-lifecycles">https://reactjs.org/link/unsafe-component-lifecycles</a> for details.</font><code>componentWillMount</code>已被重命名，不推荐使用。<br>严格模式下：<font color='red'>react-dom.development.js:86 Warning: Using UNSAFE_componentWillMount in strict mode is not recommended and may indicate bugs in your code. See <a target="_blank" rel="noopener" href="https://reactjs.org/link/unsafe-component-lifecycles">https://reactjs.org/link/unsafe-component-lifecycles</a> for details.</font></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Vote</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">  state = &#123;</span><br><span class="line">    <span class="attr">supportVote</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="attr">nagativeVote</span>: <span class="number">0</span></span><br><span class="line">  &#125; <span class="comment">// 默认值为 null</span></span><br><span class="line"></span><br><span class="line">  <span class="title function_">componentWillMount</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;组件渲染前 componentWillMount&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> &#123;supportVote, nagativeVote&#125; = <span class="variable language_">this</span>.<span class="property">state</span></span><br><span class="line">    <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span>=&gt;</span>&#123;</span></span><br><span class="line"><span class="language-xml">        this.setState(&#123;</span></span><br><span class="line"><span class="language-xml">          supportVote: ++supportVote</span></span><br><span class="line"><span class="language-xml">        &#125;)</span></span><br><span class="line"><span class="language-xml">      &#125;&#125;&gt;赞成&#123;supportVote&#125;<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span>=&gt;</span>&#123;</span></span><br><span class="line"><span class="language-xml">        this.state.nagativeVote++</span></span><br><span class="line"><span class="language-xml">        this.forceUpdate()</span></span><br><span class="line"><span class="language-xml">      &#125;&#125;&gt;反对&#123;nagativeVote&#125;<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="step4-——-render"><a href="#step4-——-render" class="headerlink" title="step4 —— render"></a>step4 —— render</h3><p>组件渲染阶段</p>
<h3 id="step5-——-componentDidMount"><a href="#step5-——-componentDidMount" class="headerlink" title="step5 —— componentDidMount"></a>step5 —— componentDidMount</h3><p>第一次渲染结束，virtualDOM 已经更新成完真实 DOM，可以进行 DOM 操作</p>
<h2 id="组件更新"><a href="#组件更新" class="headerlink" title="组件更新"></a>组件更新</h2><h3 id="step6-——-shouldComponentUpdate"><a href="#step6-——-shouldComponentUpdate" class="headerlink" title="step6 —— shouldComponentUpdate"></a>step6 —— shouldComponentUpdate</h3><p>是否允许组件更新，<span class='custom-box custom-box-933'><code>react.component.forceUpdate</code> 不会触发 shouldComponentUpdate 生命周期更新。</span></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Vote</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">  state = &#123;</span><br><span class="line">    <span class="attr">supportVote</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="attr">nagativeVote</span>: <span class="number">0</span></span><br><span class="line">  &#125; <span class="comment">// 默认值为 null</span></span><br><span class="line"></span><br><span class="line">  <span class="title function_">componentWillMount</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;组件渲染前 componentWillMount&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">componentDidMount</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;componentDidMount：组件已挂载至页面&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 状态修改，触发组件更新</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">*</span>&#125; nextProps 要修改的属性</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">*</span>&#125; nextState 要修改的状态</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@returns</span> boolean 是否允许更新</span></span><br><span class="line"><span class="comment">   */</span>  </span><br><span class="line">  <span class="title function_">shouldComponentUpdate</span>(<span class="params">nextProps, nextState</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;shouldComponentUpdate: 是否允许组件更新&#x27;</span>,<span class="variable language_">this</span>.<span class="property">state</span>, nextState)</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * return true 允许更新，执行下一个操作</span></span><br><span class="line"><span class="comment">     * return false 不允许更新</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> &#123;supportVote, nagativeVote&#125; = <span class="variable language_">this</span>.<span class="property">state</span></span><br><span class="line">    <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span>=&gt;</span>&#123;</span></span><br><span class="line"><span class="language-xml">        this.setState(&#123;</span></span><br><span class="line"><span class="language-xml">          supportVote: ++supportVote</span></span><br><span class="line"><span class="language-xml">        &#125;)</span></span><br><span class="line"><span class="language-xml">      &#125;&#125;&gt;赞成&#123;supportVote&#125;<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span>=&gt;</span>&#123;</span></span><br><span class="line"><span class="language-xml">        this.state.nagativeVote++</span></span><br><span class="line"><span class="language-xml">        this.forceUpdate()</span></span><br><span class="line"><span class="language-xml">      &#125;&#125;&gt;反对&#123;nagativeVote&#125;<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="step7-——-componentWillUpdate"><a href="#step7-——-componentWillUpdate" class="headerlink" title="step7 —— componentWillUpdate"></a>step7 —— componentWillUpdate</h3><p><font color='#ffa'>Warning: componentWillUpdate has been renamed, and is not recommended for use. See <a target="_blank" rel="noopener" href="https://reactjs.org/link/unsafe-component-lifecycles">https://reactjs.org/link/unsafe-component-lifecycles</a> for details.<br></font></p>
<blockquote>
<p>这个阶段状态未更新</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Vote</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.component</span> &#123;</span><br><span class="line">  ...</span><br><span class="line">  <span class="title function_">componentWillUpdate</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;componentWillUpdate:&#x27;</span>, <span class="variable language_">this</span>.<span class="property">state</span>) <span class="comment">// &#123;</span></span><br><span class="line">    <span class="comment">//    &quot;supportVote&quot;: 0,</span></span><br><span class="line">    <span class="comment">//    &quot;nagativeVote&quot;: 0</span></span><br><span class="line">    <span class="comment">// &#125;</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;&gt;</span>...<span class="tag">&lt;/&gt;</span></span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="step8-——-render"><a href="#step8-——-render" class="headerlink" title="step8 —— render"></a>step8 —— render</h3><h3 id="step9-——-componentDidUpdate"><a href="#step9-——-componentDidUpdate" class="headerlink" title="step9 —— componentDidUpdate"></a>step9 —— componentDidUpdate</h3><p>组件更新完毕</p>
<h2 id="父子组件渲染"><a href="#父子组件渲染" class="headerlink" title="父子组件渲染"></a>父子组件渲染</h2><p>React 组件更新遵循深度优先原则，父组件在操作中遇到子组件，一定是把子组件处理完后，才继续处理父组件。</p>
<h3 id="父组件第一次渲染"><a href="#父组件第一次渲染" class="headerlink" title="父组件第一次渲染"></a>父组件第一次渲染</h3><pre class="mermaid">flowchart TB
  step1([父组件 ComponentWillMount]) --> step2([父组件 render])
  subgraph " "
    step3[子组件 ComponentWillMount] --> step4[子组件 render]
    step4 --> step5[子组件 ComponentDidMount]
  end

  step2 --> step3[子组件 ComponentWillMount]
  step5 --> step6([父组件 ComponentDidMount])</pre>

<h3 id="父组件更新"><a href="#父组件更新" class="headerlink" title="父组件更新"></a>父组件更新</h3><pre class="mermaid">flowchart TB
  step1([父组件 shouldComponentUpdate]) --> step2([父组件 ComponentWillUpdate])
  step2 --> step3([父组件 render])
  subgraph " "
    step4[子组件 componentWillReceiveProps] --> step4_1[子组件 shouldComponentUpdate]
    step4_1 --> step5[子组件 ComponentWillUpdate]
    step5 --> step6[子组件 render]
    step6 --> step7[子组件 componentDidUpdate]
  end

  step3 --> step4
  step7 --> step8([父组件 ComponentDidUpdate])</pre>

<img  src=http://www.plantuml.com/plantuml/svg/SoWkIImgAStDuQfHBiZCowvvsZ7xwUvTpwPlg-6oIixFAoufAaqkoI-ovh9AJornIItAB4jD2Iv9B4brAyhF3IZABoZMoDUiuQfvDdlBisaR8FhmgtpQk-F5thrWbGwfUIb0km40>

<p>React 组件中，生命周期可基本分为三个状态</p>
<h3 id="Mounting-组件的挂载"><a href="#Mounting-组件的挂载" class="headerlink" title="Mounting 组件的挂载"></a>Mounting 组件的挂载</h3><pre class="mermaid">graph LR
A(React 组件渲染) --> B(构造DOM元素)
B --> C(展示到页面)</pre>
<span id="more"></span>
<p>如上过程称为<strong>组件挂载</strong><br>执行的相关生命周期方法：</p>
<ol>
<li> getDerivedStateFromProps</li>
</ol>
<p>Mounting：已开始挂载 DOM<br>Updating：重新渲染组件 DOM<br>UnMounting：已卸载真实的 DOM</p>
<p>关于生命周期的方法<br>ComponentWillMount()：在渲染前调用，可以在客户端，也可以在服务端<br>ComponentDidMount()：第一次渲染后调用，只作用于客户端<br>ComponentWillUpdate()/UNSAFE_componentWillUpdate<br><font color="Orange"><br>  <code>componentWillUpdate has been renamed，and is not recommended for use   Move data fetching code or side effects to ComponentDidUpdate   Rename componentWillUpdate to UNSAFE_componentWillUpdate to suppress this warning in non-strict mode，In React 18.x, only the UNSAFE_ name will work. to rename all deprecated lifecycles to their new names, you can run &#39;npx react-codemod rename-unsafe-lifecycles&#39; in your project source folder.</code><br></font></p>
<blockquote>
<p>在组件接收到新的 props 参数或者 State 状态，<u>渲染之前调用</u>。<strong>该方法初始化时不会被调用</strong><br>  ComponentWillUpdate 未来会废弃<br>  平缓过渡 React 16.3 版本中，为不安全的生命周期引入别名 UNSAFE_componentWillUpdate<br>  废弃旧版本的生命周期保留至 React 17</p>
</blockquote>
<p>UNSAFE_componentWillUpdate + getDerivedStateFromProps<br><font color="red"><br>  <code>Unsafe legacy lifecycles will not be called for components using new components APIs   App uses getDerivedsTATEfromProps() but also contains the following legacys UNSAFE_componentWillUpdate</code><br></font></p>
<p>getDerivedStateFromProps()</p>
<blockquote>
<p><u>在组件实例化及接收到新的 props 后调用</u>，返回一个对象去更新 state，或者返回 null 不更新，<u>用于确认当前组件<strong>是否需要重新渲染</strong></u>这个生命周期将作为 componentWillReceiveProps() 的安全替代者</p>
</blockquote>
<p>getSnapshotBeforeUpdate()</p>
<blockquote>
<p><u>更新之前被调用</u><strong>这个生命周期返回值将作为第3个参数传递给 componentDidUpdate() 方法</strong><font color="red">对于保存滚动位置有用</font></p>
</blockquote>
<p><font color="red">Warning: App: getSnapshotBeforeUpdate should be used with ComponentDidUpdate(). This component defines getSnapshotBeforeUpdate() only</font></p>
<p>ComponentDidUpdate()：组件完成更新后会立即调用，另外该方法。<strong>该方法初始化时不会被调用</strong><br>ComponentWillMount()：在组件从 Dom 中移除之前会被立刻调用。</p>

    </div>
</article>


      </div>
      
       <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="/tags/">Tags</a></li>
         
          <li><a target="_blank" rel="noopener" href="https://github.com/HelenZhangLP">Projects</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#the-components-is-not-recommended"><span class="toc-number">1.</span> <span class="toc-text">the components is not recommended</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%B8%B2%E6%9F%93"><span class="toc-number">2.</span> <span class="toc-text">第一次渲染</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#step1-%E2%80%94%E2%80%94-%E5%88%9D%E5%A7%8B%E5%8C%96%E5%B1%9E%E6%80%A7-amp-amp-%E8%80%83%E9%AA%8C%E8%A7%84%E5%88%99"><span class="toc-number">2.1.</span> <span class="toc-text">step1 —— 初始化属性&amp;&amp;考验规则</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#step2-%E2%80%94%E2%80%94-%E5%88%9D%E5%A7%8B%E5%8C%96%E7%8A%B6%E6%80%81"><span class="toc-number">2.2.</span> <span class="toc-text">step2 —— 初始化状态</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#step3-%E2%80%94%E2%80%94-ComponentWillMount"><span class="toc-number">2.3.</span> <span class="toc-text">step3 —— ComponentWillMount</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#step4-%E2%80%94%E2%80%94-render"><span class="toc-number">2.4.</span> <span class="toc-text">step4 —— render</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#step5-%E2%80%94%E2%80%94-componentDidMount"><span class="toc-number">2.5.</span> <span class="toc-text">step5 —— componentDidMount</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%84%E4%BB%B6%E6%9B%B4%E6%96%B0"><span class="toc-number">3.</span> <span class="toc-text">组件更新</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#step6-%E2%80%94%E2%80%94-shouldComponentUpdate"><span class="toc-number">3.1.</span> <span class="toc-text">step6 —— shouldComponentUpdate</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#step7-%E2%80%94%E2%80%94-componentWillUpdate"><span class="toc-number">3.2.</span> <span class="toc-text">step7 —— componentWillUpdate</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#step8-%E2%80%94%E2%80%94-render"><span class="toc-number">3.3.</span> <span class="toc-text">step8 —— render</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#step9-%E2%80%94%E2%80%94-componentDidUpdate"><span class="toc-number">3.4.</span> <span class="toc-text">step9 —— componentDidUpdate</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%88%B6%E5%AD%90%E7%BB%84%E4%BB%B6%E6%B8%B2%E6%9F%93"><span class="toc-number">4.</span> <span class="toc-text">父子组件渲染</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%88%B6%E7%BB%84%E4%BB%B6%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%B8%B2%E6%9F%93"><span class="toc-number">4.1.</span> <span class="toc-text">父组件第一次渲染</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%88%B6%E7%BB%84%E4%BB%B6%E6%9B%B4%E6%96%B0"><span class="toc-number">4.2.</span> <span class="toc-text">父组件更新</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Mounting-%E7%BB%84%E4%BB%B6%E7%9A%84%E6%8C%82%E8%BD%BD"><span class="toc-number">4.3.</span> <span class="toc-text">Mounting 组件的挂载</span></a></li></ol></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://helenzhanglp.github.io/2016/06/15/React-LifeCycle/"><i class="fa fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://helenzhanglp.github.io/2016/06/15/React-LifeCycle/&text=React 生命周期"><i class="fa fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://helenzhanglp.github.io/2016/06/15/React-LifeCycle/&title=React 生命周期"><i class="fa fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://helenzhanglp.github.io/2016/06/15/React-LifeCycle/&is_video=false&description=React 生命周期"><i class="fa fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=React 生命周期&body=Check out this article: https://helenzhanglp.github.io/2016/06/15/React-LifeCycle/"><i class="fa fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://helenzhanglp.github.io/2016/06/15/React-LifeCycle/&title=React 生命周期"><i class="fa fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://helenzhanglp.github.io/2016/06/15/React-LifeCycle/&title=React 生命周期"><i class="fa fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://helenzhanglp.github.io/2016/06/15/React-LifeCycle/&title=React 生命周期"><i class="fa fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://helenzhanglp.github.io/2016/06/15/React-LifeCycle/&title=React 生命周期"><i class="fa fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://helenzhanglp.github.io/2016/06/15/React-LifeCycle/&name=React 生命周期&description=&lt;pre class=&#34;mermaid&#34;&gt;  flowchart LR
  subgraph 初次渲染阶段
    subgraph 初始化阶段
      start([strart]) --&gt;|初始化属性&amp;&amp;考验规则|step1[getDefaultProps]
      step1 --&gt;|初始化状态| stpe2[getInitialState]
    end
    subgraph 第一次渲染
      step3[&#34;~UNSAFE_ComponentWillMount~&#34;] --&gt; step4[render]
      step4 --&gt; step5[componentDidMount]
    end
    初始化阶段  --&gt; 第一次渲染
  end&lt;/pre&gt;
&lt;pre class=&#34;mermaid&#34;&gt;  flowchart LR
  第一次渲染 --&gt; 组件更新
  subgraph 组件更新
    condition1{属性改变 or 状态改变} --&gt;|属性改变| step6_1[&#34;~UNSAFE_componentWillReceiveProps~&#34;]
    condition1 --&gt;|状态改变| step6{shouldComponentUpdate}
    step6_1 --&gt; step6
    step6 --&gt;|yes| step7[componentWillUpdate]
    step7 --&gt;|dom-diff| step8[render]
    step8 --&gt; step9[componentDidUpdate]
  end&lt;/pre&gt;
&lt;pre class=&#34;mermaid&#34;&gt;  flowchart LR
  初次渲染阶段 --&gt; 组件更新
  组件更新 --&gt; 组件销毁
  subgraph 组件销毁
    step10[componentwillUnmount]
  end&lt;/pre&gt;
&lt;blockquote&gt;
&lt;p&gt;UNSAFE_* 屏蔽 warning&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;the-components-is-not-recommended&#34;&gt;&lt;a href=&#34;#the-components-is-not-recommended&#34; class=&#34;headerlink&#34; title=&#34;the components is not recommended&#34;&gt;&lt;/a&gt;&lt;font color=&#34;red&#34;&gt;the components is not recommended&lt;/font&gt;&lt;/h2&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;serial number&lt;/th&gt;
&lt;th&gt;component name&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;&lt;tr&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;ComponentWillMount&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;componentWillUpdate&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;h2 id=&#34;第一次渲染&#34;&gt;&lt;a href=&#34;#第一次渲染&#34; class=&#34;headerlink&#34; title=&#34;第一次渲染&#34;&gt;&lt;/a&gt;第一次渲染&lt;/h2&gt;&lt;h3 id=&#34;step1-——-初始化属性-amp-amp-考验规则&#34;&gt;&lt;a href=&#34;#step1-——-初始化属性-amp-amp-考验规则&#34; class=&#34;headerlink&#34; title=&#34;step1 —— 初始化属性&amp;amp;&amp;amp;考验规则&#34;&gt;&lt;/a&gt;step1 —— 初始化属性&amp;amp;&amp;amp;考验规则&lt;/h3&gt;&lt;figure class=&#34;highlight javascript&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;Vote&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;extends&lt;/span&gt; &lt;span class=&#34;title class_ inherited__&#34;&gt;React.Component&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;comment&#34;&gt;/**&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;   * method1: handle init props in constructor function(在 constructor 中初始化属性)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;    constructor(props) &amp;#123;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;      super(props) // 把传递进来的 &amp;#123;...props&amp;#125; 挂载到 this&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;  */&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;span class=&#34;comment&#34;&gt;/**&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;  * method2: 不通过显式声明 constructor 初始化属性，react 内部机制会处理&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;  */&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&#34;step2-——-初始化状态&#34;&gt;&lt;a href=&#34;#step2-——-初始化状态&#34; class=&#34;headerlink&#34; title=&#34;step2 —— 初始化状态&#34;&gt;&lt;/a&gt;step2 —— 初始化状态&lt;/h3&gt;"><i class="fa fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
      <ul>
        <li id="toc"><a class="icon" href="#" onclick='$("#toc-footer").toggle();return false;'><i class="fa fa-list fa-lg" aria-hidden="true"></i> TOC</a></li>
        <li id="share"><a class="icon" href="#" onclick='$("#share-footer").toggle();return false;'><i class="fa fa-share-alt fa-lg" aria-hidden="true"></i> Share</a></li>
        <li id="top" style="display:none"><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a></li>
        <li id="menu"><a class="icon" href="#" onclick='$("#nav-footer").toggle();return false;'><i class="fa fa-bars fa-lg" aria-hidden="true"></i> Menu</a></li>
      </ul>
    </div>

  </div>
</div>

      
      <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2024
      Helen Zhang
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        
          <li><a href="/">
              Home
            </a></li>
          
          <li><a href="/about/">
              About
            </a></li>
          
          <li><a href="/archives/">
              Writing
            </a></li>
          
          <li><a href="/tags/">
              Tags
            </a></li>
          
          <li><a target="_blank" rel="noopener" href="https://github.com/HelenZhangLP">
              Projects
            </a></li>
          
      </ul>
    </nav>
  </div>
</footer>


  <!-- <script src='https://unpkg.com/mermaid@10.4.0/dist/mermaid.min.js'></script> -->
  <script src="https://cdn.bootcdn.net/ajax/libs/mermaid/10.4.0/mermaid.min.js"></script>
  <script>
    if (window.mermaid) {
      mermaid.initialize({ theme: 'default' });
    }
  </script>
  
      
<script src="/lib/justified-gallery/jquery.justifiedGallery.min.js"></script>


<script src="/js/main.js"></script>

<!-- Google Analytics -->

<!-- Disqus Comments -->


    </div>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</body>
</html>
